<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Online Store</title>
           <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static "css/base.css" %}">
    <link rel="stylesheet" href="{% static 'css/all_products.css' %}">
</head>
<body>
{% block title %}
    <div class="header">
        <div class="logo">
            <a href="{% url 'all_products' %}">Home</a>
        </div>
        <div class="search">
            <form id="qq" method="get" action="{% url 'all_products' %}">
                <input type="text" placeholder="Search here..." name="search">
            </form>
            <button id="button-search">üîç</button>
        </div>
        <nav>
            <ul class="menu">
                <li class="menu-item">
                    <a  class="p-categories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
                    <ul class="sub-menu">
                        {% for category in categories %}
                            {% if category.parent is None %}
                            <li class="category-item">
                                <a href="/{{ category }}" class="category">{{ category }}</a>
                                <ul class="sub-sub-menu">
                                    {% for subcategory in category.children.all %}
                                        <li><a href="/{{ subcategory }}" class="subcategory">{{ subcategory }}</a></li>
                                        <!-- –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–¥–µ—Å—å, –µ—Å–ª–∏ –µ—Å—Ç—å -->
                                    {% endfor %}
                                </ul>
                            {% endif %}
                            </li>
                        {% endfor %}
                    </ul>
                </li>
            </ul>
        </nav>
        <div class="cart">
            <a href="{% url 'cart_view' %}">üõí</a>
            <p class="len_order">{{ len_order }}</p>
        </div>
        <div class="mobile-menu-icon">
            <span></span>
            <span></span>
            <span></span>
        </div>
            <nav class="mobile-menu-panel">
                <a href="{% url 'cart_view' %}">–ö–æ—Ä–∑–∏–Ω–∞</a>
                <div class="category_mobile">
                    <a id="toggle-categories" class="p-categories_mobile">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a>
                    <ul class="sub-menu_mobile">
                        {% for category in categories %}
                            {% if category.parent is None %}
                                <li class="category-item_mobile">
                                    <a href="/{{ category }}" class="category_mobile">{{ category }}</a>
                                    <ul class="sub-sub-menu_mobile">
                                        {% for subcategory in category.children.all %}
                                            <li><a href="/{{ subcategory }}" class="subcategory_mobile">{{ subcategory }}</a></li>
                                            <!-- –î–æ–±–∞–≤—å—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–¥–µ—Å—å, –µ—Å–ª–∏ –µ—Å—Ç—å -->
                                        {% endfor %}
                                    </ul>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </nav>
        </div>
{% endblock %}
    <div class="container">
        <div class="product-grid">
{#            {% if search_query %}#}
{#                <h2 class="search-header">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –¥–ª—è "{{ search_query }}"</h2>#}
{#            {% endif %}#}
            {% for i in products %}
                {% if i.available %}
                <a href="/{{ i.id }}" class="product">
                    <div class="product-content">
                        {% for image in i.images.all %}
                            {% if forloop.first %}
                                <img class="product-image" src="{{ image.image.url }}">
                            {% endif %}
                        {% endfor %}
                        <div class="a">
                            <p class="product-title">{{ i.name }}</p>
                            <p class="product-price">{{ i.price }} UAH</p>
                        </div>
                    </div>
                </a>
                {% endif %}
            {% empty %}
                {% if search_query %}
                    <p class="no-results">–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è "{{ search_query }}"</p>
                {% else %}
                    <p class="no-results"> –í –º–∞–≥–∞–∑–∏–Ω–µ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤</p>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</body>
</html>
<script>
document.addEventListener('DOMContentLoaded', function() {
    var toggleCategories = document.getElementById('toggle-categories');
    var subMenus = document.querySelectorAll('.sub-sub-menu_mobile');

    toggleCategories.addEventListener('click', function(event) {
        event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ

        var subMenuMobile = document.querySelector('.sub-menu_mobile');
        subMenuMobile.classList.toggle('show-sub-menu');
    });

    var categories = document.querySelectorAll('.category-item_mobile');

    categories.forEach(function(category) {
        category.addEventListener('dblclick', function(event) {
            // –†–∞–∑—Ä–µ—à–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º –∫–ª–∏–∫–µ (–ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ)
            window.location = category.querySelector('.category_mobile').getAttribute('href');
        });

        category.addEventListener('click', function(event) {
            if (!event.target.classList.contains('subcategory_mobile')) {
                event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Å—ã–ª–∫–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ –æ–¥–∏–Ω–æ—á–Ω–æ–º –∫–ª–∏–∫–µ

                var subSubMenu = this.querySelector('.sub-sub-menu_mobile');
                subMenus.forEach(function(subMenu) {
                    subMenu.style.display = 'none';
                });
                subSubMenu.style.display = 'block';
            }
        });
    });
});
    $(document).ready(function(){
                $('#toggle-categories').click(function(){
                    $('.sub-menu_mobile').toggle(); // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –ø–æ–¥–º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"
                });
            });
        document.getElementById('button-search').addEventListener('click', function(event) {
        event.preventDefault(); // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏

        // –ü–æ–ª—É—á–∞–µ–º —Ñ–æ—Ä–º—É –ø–æ –µ–µ ID –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–µ
        const form = document.getElementById('qq');
        form.submit();
        });
        // –ù–∞–π—Ç–∏ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–æ–¥–º–µ–Ω—é
        const categoriesWithSubMenu = document.querySelectorAll('nav ul li');

        // –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å –ø–æ–¥–º–µ–Ω—é –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è
        categoriesWithSubMenu.forEach(category => {
            category.addEventListener('mouseenter', () => {
                const subMenu = category.querySelector('ul');
                if (subMenu) {
                    subMenu.style.display = 'block';
                }
            });

            category.addEventListener('mouseleave', () => {
                const subMenu = category.querySelector('ul');
                if (subMenu) {
                    subMenu.style.display = 'none';
                }
            });
        });

        const mobileMenuIcon = document.querySelector('.mobile-menu-icon');

// –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ –∏–∫–æ–Ω–∫–µ –º–µ–Ω—é
mobileMenuIcon.addEventListener('click', function() {
    // –î–æ–±–∞–≤–ª—è–µ–º/—É–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å 'active' –ø—Ä–∏ –∫–ª–∏–∫–µ
    this.classList.toggle('active');
});
</script>